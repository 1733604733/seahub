{% extends base_template %}
{% load seahub_tags i18n %}

{% block main_panel %}
{% if not cloud_mode or not no_quota %}
<div class="narrow-panel">
    <h3>{% trans "Update file" %}
            {% for name, link in zipped %}
              {% if not forloop.last %}
                <a href="{{ SITE_ROOT }}repo/{{ repo.id }}/?p={{ link|urlencode }}">{{ name }}</a> / 
              {% else %}
                {{ name }}
              {% endif %}
            {% endfor %}
    </h3>
    <form id="upload-file-form" enctype="multipart/form-data" method="post" action="{{ update_url }}?head={{ head_id }}">
        <input type="hidden" name="target_file" value="{{ target_file }}" />
        <input type="file" name="file" id="file" />
        <p>({% trans "Smaller than" %} {{ max_upload_file_size|filesizeformat }})</p>
        <p id="error-msg" class="error">{{ error_msg }}</p>
        <input id="upload-submit" type="submit" value="{% trans "Submit" %}" class="submit" />
    </form>
    
    <div id="upload-progress" class="hide">
        <p>{% trans "Uploading rate:" %} <span id="upload-progress-text">{% trans "Fetching..." %}</span></p>
        <div id="task-progress-bar" class="hide"></div>
        <button id="upload-cancel">{% trans "Cancel" %}</button>
    </div>
    <iframe id="request-progress" class="hide"><!--for chrome--></iframe>
</div>
{% else %}
<div class="text-panel">
    <p class="error">{% trans "The owner of this library has ran out of space. Update failed." %}</p>
</div>
{% endif %}
{% endblock %}

{% block extra_script %}
{% include 'snippets/file_upload_progress_js.html' %}
{% endblock %}
