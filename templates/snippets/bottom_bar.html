{% load url from future %}
var Bottom_bar = '<div id="bottom-bar"><button id="recommend">推荐到群组</button> <button id="click-into-group">到所在群组</button></div>';
$('#wrapper').append(Bottom_bar);
$('#bottom-bar').css({'position':'fixed', 'bottom':0, 'right':'10px'});
$('#main-panel').css('margin-bottom', '28px');
$('#footer').addClass('hide');

var group_list = []
{% for group in groups %}
group_list.push('{{ group.props.group_name }} <{{ group.props.creator_name }}>');
{% endfor %}
if (group_list.length == 1) {
    $('#recommend-groups').val(group_list[0]);
}
$('#recommend').click(function() {
    $('#recommend-form').modal({appendTo: '#main'});
    addAutocomplete('#recommend-groups', '#recommend-form', group_list);
    $('.ui-autocomplete').css({'max-height': window.innerHeight - $('.ui-autocomplete-input').offset().top - $('.ui-autocomplete-input').height() - 10, 'overflow': 'auto'});
});

$('#click-into-group').click(function() {
    {% if groups|length == 1 %}
    // only one group, just turn to group page
    {% for group in groups %}
    location.href= "{% url 'group_info' group.id %}";
    {% endfor %}
    
    {% else %}
    // more than one group, then let user choose
    var content = '{{ repo_group_str|escapejs }}';
    $('#ls-ch').html(content).modal({
        appendTo:'#main',
        maxHeight: window.innerHeight - 57,
        autoResize:true
    });

    {% endif %}
});

$('#recommend-submit').click(function() {
    if (!$.trim($('#recommend-msg').val())) {
        apply_form_error('recommend-form', '推荐语不能为空。');
        return false;   
    }
});

