{% extends "admin_base.html" %}

{% block nav_useradmin_class %}class="cur"{% endblock %}
{% block left_panel %}
<!--
<ul>
    <li><a href="{{ SITE_ROOT }}useradmin/add/">添加用户</a></li>
</ul>
-->
<h3>已用空间</h3>
<p>{{ quota_usage|filesizeformat }} / 2 GB</p>

{% endblock %}

{% block right_panel %}
<h3>{{ email }} 拥有的同步目录</h3>
{% if owned_repos %}
<table>
    <tr>
        <th width="30%">名字</th>
        <th width="50%">描述</th>
        <th width="20%">操作</th>
    </tr>

    {% for repo in owned_repos %}
    <tr>
        <td><a href="{{ SITE_ROOT }}repo/{{ repo.props.id }}/">{{ repo.props.name }}</a></td>
        <td>{{ repo.props.desc }}</td>
        <td>
        <button data="{{ SITE_ROOT }}repo/remove/{{ repo.props.id }}/?next={{ request.path }}" class="repo-delete-btn">删除</button>
        </td>
    </tr>
    {% endfor %}
</table>
{% else %}
<p>暂无</p>
{% endif %}

<h3>共享给 {{ email }} 的同步目录</h3>
{% if in_repos %}
<table class="repo-list">
    <tr>
        <th width="30%">名字</th>
        <th width="30%">共享来源</th>
        <th width="40%">描述</th>
    </tr>

    {% for repo in in_repos %}
    <tr>
        <td><a href="{{ SITE_ROOT }}repo/{{ repo.props.id }}">{{ repo.props.name }}</a></td>
        <td>{{ repo.props.shared_email }}</td>
        <td>{{ repo.props.desc }}</td>
        <td>
        </td>
    </tr>
    {% endfor %}
</table>
{% else %}
<p>暂无</p>
{% endif %}

<h3>{{ email }} 的计算机</h3>
<table class="user-list">
    <tr>
        <th width="60%">计算机名</th>
        <th width="20%">角色</th>
        <th width="20%">状态</th>
    </tr>

    {% for username, roles in user_dict.items %}
    <tr>
      {% if username %}
      <td>{{ username }}</td>
      {% else %}
      <td>未知</td>
      {% endif %}
      
      {% if roles %}
      <td>{{ roles }}</td>
      <td>已验证</td>
      {% else %}
      <td>无</td>
      <td>未验证</td>
      {% endif %}
      
    </tr>
    {% endfor %}
</table>

{% endblock %}
