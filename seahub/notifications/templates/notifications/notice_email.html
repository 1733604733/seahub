{% extends 'email_base.html' %}

{% load i18n seahub_tags %}

{% block email_con %}

<style type="text/css">
table { width:100%; margin:12px 0 20px; table-layout:fixed; border-spacing: 0; border-collapse: collapse;}
td, th { font-size: 13px; padding: 5px 3px; word-wrap: break-word; border-bottom: 1px solid #eee; }
th { text-align: left; font-weight: normal; color: #9c9c9c; }
td { color: #333; }
p { line-height: 1.5; margin:.2em 0; }
.hi { color:#121214;font-size:14px;margin-bottom:12px; }
.amount { font-size:14px;color:#434144; }
.avatar-cell { text-align:center; vertical-align:top; padding-top:8px; }
.avatar {border-radius: 1000px;}
.topic { padding: 4px 13px; border-left: 3px solid #e0e0e0; margin-left: 7px; }
.brief, .detail { margin-right:10px; }
</style>

<p class="hi">{% blocktrans with name=to_user|email2nickname %}Hi, {{ name }}{% endblocktrans %}</p>
<p class="amount">
{% blocktrans count num=notice_count %}
You've got 1 new notice on {{ site_name }}:
{% plural %}
You've got {{num}} new notices on {{ site_name }}:
{% endblocktrans %}
</p>

    <table>
        <tr>
            <th width="10%"></th>
            <th width="70%">{% trans "Message" %}</th>
            <th width="20%">{% trans "Time" %}</th>
        </tr>
        {% for notice in notices %}
        <tr>
            <td class="avatar-cell">{{notice.avatar|safe}}</td>
            <td>
                {% if notice.is_group_msg %}
                    <p class="brief">{% blocktrans with user=notice.notice_from grp_url=notice.group_url grp_name=notice.group_name%}{{user}} posted a new discussion in <a href="{{url_base}}{{grp_url}}">{{grp_name}}</a>{% endblocktrans %}</p>
                    {% if notice.grp_msg %}
                    <p class="detail">{{notice.grp_msg}}</p>
                    {% endif %}

                {% elif notice.is_grpmsg_reply %}
                    <p class="brief">{% blocktrans with user=notice.notice_from reply_url=notice.group_msg_reply_url%}{{user}} replied your <a href="{{url_base}}{{reply_url}}">group discussion</a>{% endblocktrans %}</p>
                    {% if notice.grp_reply_msg %}
                    <div class="detail">
                        {% if notice.grpmsg_topic %}
                        <p class="topic">{{notice.grpmsg_topic|truncatechars:45}}</p>
                        {% endif %}
                        <p>{{notice.grp_reply_msg}}</p>
                    </div>
                    {% endif %}

                {% elif notice.is_repo_share_msg %}
                    <p class="brief">{% blocktrans with user=notice.notice_from lib_url=notice.repo_url lib_name=notice.repo_name%}{{user}} has shared a library named <a href="{{url_base}}{{lib_url}}">{{lib_name}}</a> to you.{% endblocktrans %}</p>

                {% elif notice.is_priv_file_share_msg %}
                    <p class="brief">{% blocktrans with user=notice.notice_from file_url=notice.priv_shared_file_url file_name=notice.priv_shared_file_name %}{{user}} has shared a file named <a href="{{url_base}}{{file_url}}">{{file_name}}</a> to you.{% endblocktrans %}</p>

                {% elif notice.is_user_message %}
                    <p class="brief">{% blocktrans with msg_url=notice.user_msg_url user=notice.notice_from %}You have received a <a href="{{ url_base }}{{msg_url}}">new message</a> from {{user}}.{% endblocktrans %}</p>
                    {% if notice.user_msg %}
                    <p class="detail">{{notice.user_msg}}</p>
                    {% endif %}

                {% elif notice.is_file_uploaded_msg %}
                    <p class="brief">{% blocktrans with file_url=notice.file_link file_name=notice.file_name folder_url=notice.folder_link folder_name=notice.folder_name %}A file named <a href="{{url_base}}{{file_url}}">{{file_name}}</a> is uploaded to your folder <a href="{{url_base}}{{folder_url}}">{{folder_name}}</a>.{% endblocktrans %}</p>

                {% elif notice.is_group_join_request %}
                <p class="brief">{% blocktrans with user_url=notice.grpjoin_user_profile_url user=notice.notice_from grp_url=notice.grpjoin_group_url grp_name=notice.grpjoin_group_name msg=notice.grpjoin_request_msg %}User <a href="{{url_base}}{{user_url}}">{{user}}</a> has asked to join group <a href="{{url_base}}{{grp_url}}">{{grp_name}}</a>, verification message: {{msg}}{% endblocktrans %}</p>
              {% endif %}
            </td>
            <td>{{ notice.timestamp|date:"Y-m-d G:i:s"}}</td>
        </tr>
        {% endfor %}
    </table>

<p style="font-size:14px;color:#434144;">
{% trans "Go check out at the following page:" %}<br />
{{ url_base }}{% url 'user_notification_list' %}
</p>
{% endblock %}
